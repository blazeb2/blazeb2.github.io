import{_ as a,h as s,g as i,G as t}from"./chunks/framework.DvBEbZPB.js";const u=JSON.parse('{"title":"配置环境","description":"Cloudflare配置 将你的图床地址进行重写","frontmatter":{"lang":"zh-cn","title":"配置环境","description":"Cloudflare配置 将你的图床地址进行重写"},"headers":[],"relativePath":"guide/environment.md","filePath":"guide/environment.md","lastUpdated":1719114859000}'),e={name:"guide/environment.md"},l=t(`<h1 id="cloudflare配置" tabindex="-1">Cloudflare配置 <a class="header-anchor" href="#cloudflare配置" aria-label="Permalink to &quot;Cloudflare配置&quot;">​</a></h1><ul><li>域名：域名需要使用 Cloudflare 的 NS服务器</li></ul><h2 id="step-1-dns配置" tabindex="-1">Step. 1: DNS配置 <a class="header-anchor" href="#step-1-dns配置" aria-label="Permalink to &quot;Step. 1: DNS配置&quot;">​</a></h2><p>如：我将 <code>imgcdn.admirelight.com</code> 作为我的图床链接。那么我就要在DNS中添加一条CNAME记录，并指向<a href="/guide/prepare.html#step-4-查看桶域名">文件地址</a>中的域名。</p><p><img src="https://cloud.ryanuo.cc/hexo/api/0c69f9ba-b516-4799-9dba-1353e6d9e5df.png" alt="" data-fancybox="gallery"></p><h2 id="step-2-重定向-缓冲处理" tabindex="-1">Step. 2: 重定向&amp;&amp;缓冲处理 <a class="header-anchor" href="#step-2-重定向-缓冲处理" aria-label="Permalink to &quot;Step. 2: 重定向&amp;&amp;缓冲处理&quot;">​</a></h2><ul><li>在 <strong>规则</strong> --&gt; <strong>页面规则</strong> 中，添加以下内容。</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>imgcdn.admirelight.com/file/你的桶名称/*</span></span>
<span class="line"><span></span></span>
<span class="line"><span>https://f004.backblazeb2.com/file/你的桶名称/$1</span></span></code></pre></div><p><img src="https://cloud.ryanuo.cc/hexo/api/68091800-449a-4daa-848b-e6c59d8d77b7.png" alt="" data-fancybox="gallery"></p><h2 id="step-3-重写url" tabindex="-1">Step. 3: 重写URL <a class="header-anchor" href="#step-3-重写url" aria-label="Permalink to &quot;Step. 3: 重写URL&quot;">​</a></h2><ul><li>将 <strong>/file/bucket/</strong> 名称隐藏 隐藏桶名称</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>concat(&quot;/file/bucket&quot;, http.request.uri.path)</span></span></code></pre></div><p><img src="https://cloud.ryanuo.cc/hexo/api/53b05dc8-180d-48d0-8460-e91dd2933de8.png" alt="" data-fancybox="gallery"></p><ul><li>优化前访问路径为：<a href="https://imgcdn.admirelight.com/file/%E6%A1%B6%E5%90%8D%E5%AD%97/xxx.txt" target="_blank" rel="noreferrer">https://imgcdn.admirelight.com/file/桶名字/xxx.txt</a></li><li>优化后访问路径为：<a href="https://imgcdn.admirelight.comm/xxx.txt" target="_blank" rel="noreferrer">https://imgcdn.admirelight.comm/xxx.txt</a></li><li>去除了：file/bucket/</li></ul><h2 id="step-3-重写响应头" tabindex="-1">Step. 3: 重写响应头 <a class="header-anchor" href="#step-3-重写响应头" aria-label="Permalink to &quot;Step. 3: 重写响应头&quot;">​</a></h2><ul><li>去除不必要的响应Header</li><li>Backblaze B2会在请求的响应头中添加以下几个header参数：</li></ul><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">x</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bz</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">content</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sha1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">x</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bz</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">file</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">id</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">x</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bz</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">file</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">name</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">x</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bz</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">upload</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">timestamp</span></span></code></pre></div><ul><li>虽然影响不大，但是一看这些参数就知道你用的B2，并且这些参数头一般拿来也没啥用，可以通过CloudFlare的重写规则将其去掉。</li><li>转换规则 --&gt; 创建转换规则 --&gt; 修改响应头</li></ul><p><img src="https://cloud.ryanuo.cc/hexo/4/e0b95f22-0aae-40d0-a6c9-30071bfa8035.png" alt="" data-fancybox="gallery"><img src="https://cloud.ryanuo.cc/hexo/api/759fa15d-d7b2-414b-bc30-f44af6c61ef9.png" alt="" data-fancybox="gallery"></p>`,19),n=[l];function p(h,r,d,o,c,k){return i(),s("div",null,n)}const E=a(e,[["render",p]]);export{u as __pageData,E as default};
